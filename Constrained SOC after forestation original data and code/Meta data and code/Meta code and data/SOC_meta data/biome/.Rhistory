strip.text.x = element_blank(),
legend.position = "none"
)
# 显示
print(p)
# 保存
ggsave("GrasslandPassive.tiff",
p,
width = 12, height = 16, units = "cm", dpi = 500, device = "tiff")
######GrasslandSOC########
library(dplyr)
library(ggplot2)
# 1. 读取与筛选数据
dat <- read.csv("filled_biome_combined_data.csv")
dat3 <- dat[dat$Landuse=="Grassland",]
dat1 <- dat3[dat3$Group1=="SOC",]
# 2. 格式化数字：trim=TRUE 确保括号紧贴数字，无空隙
dat1$formatted_label <- paste0("(", format(dat1$N, big.mark = ",", trim = TRUE), ")")
# 定义颜色
dotCOLS = c("#AB82FF","#FFA500","#96CDCD")
barCOLS = c("#8073ac","#CD8500","#668B8B")
# 设置因子顺序
dat1$group <- factor(dat1$group, levels = c("T.ST", "Temperate", "Boreal"))
# Y 轴刻度准备
breaks = seq(-100, 150, by = 50)
labels = as.character(breaks)
# 3. 绘图
p <- dat1 %>%
mutate(facet = factor(facet, levels = c("0-30cm", "30+cm"))) %>%
ggplot(aes(x = group, y = OR, ymin = Lower, ymax = Upper, col = group, fill = group)) +
facet_grid(~ facet) +
# 误差棒
geom_errorbar(aes(ymin = Lower, ymax = Upper, col = group), width = 0.4, linewidth = 1) +
# 水平参考线 (0位线)
geom_hline(yintercept = 0, lty = 2, linewidth = 0.8) +
# 点 (Dot Bar)
geom_point(size = 6, shape = 21, colour = "white", stroke = 1) +
# --- 修改 1：数字在上方排成一行 ---
# y = 380 是固定高度，确保所有数字对齐成一行
geom_text(aes(y = 140, label = formatted_label),
angle = 90,             # 旋转90度
color = "black",        # 黑色字体
size = 7,               # 字体大小
hjust = 0.5,            # 水平居中对齐
fontface = "plain") +
# 设置颜色
scale_fill_manual(values = barCOLS) +
scale_color_manual(values = dotCOLS) +
# 坐标轴设置
scale_x_discrete(name = NULL) +
scale_y_continuous(name = NULL,
limits = c(-100, 150), # 调大上限给对齐的数字留空间
breaks = breaks,
labels = labels,
position = "right") +
# 主题美化
theme_minimal(base_family = "arial", base_size = 20) +
theme(
plot.background = element_blank(),
panel.background = element_blank(),
panel.grid = element_blank(),
# --- 修改 2：X轴标签旋转90度并对齐 ---
axis.text.x = element_text(color = "black",
angle = 90,
hjust = 1,    # 旋转后靠右对齐（即靠近轴线）
vjust = 0.5,  # 垂直居中
face = "bold",
size = 22),
axis.text.y = element_text(color = "black", angle = 90, face = "bold", size = 22),
axis.title = element_blank(),
axis.line = element_line(color = "black", linewidth = 1),
strip.text.x = element_blank(),
legend.position = "none"
)
# 显示
print(p)
# 保存
ggsave("GrasslandSOC.tiff",
p,
width = 12, height = 16, units = "cm", dpi = 500, device = "tiff")
######GrasslandSensivity########
library(dplyr)
library(ggplot2)
# 1. 读取与筛选数据
dat <- read.csv("filled_biome_combined_data.csv")
dat3 <- dat[dat$Landuse=="Grassland",]
dat1 <- dat3[dat3$Group1=="Sensitivity",]
# 2. 格式化数字：trim=TRUE 确保括号紧贴数字，无空隙
dat1$formatted_label <- paste0("(", format(dat1$N, big.mark = ",", trim = TRUE), ")")
# 定义颜色
dotCOLS = c("#AB82FF","#FFA500","#96CDCD")
barCOLS = c("#8073ac","#CD8500","#668B8B")
# 设置因子顺序
dat1$group <- factor(dat1$group, levels = c("T.ST", "Temperate", "Boreal"))
# Y 轴刻度准备
breaks = seq(-100, 150, by = 50)
labels = as.character(breaks)
# 3. 绘图
p <- dat1 %>%
mutate(facet = factor(facet, levels = c("0-30cm", "30+cm"))) %>%
ggplot(aes(x = group, y = OR, ymin = Lower, ymax = Upper, col = group, fill = group)) +
facet_grid(~ facet) +
# 误差棒
geom_errorbar(aes(ymin = Lower, ymax = Upper, col = group), width = 0.4, linewidth = 1) +
# 水平参考线 (0位线)
geom_hline(yintercept = 0, lty = 2, linewidth = 0.8) +
# 点 (Dot Bar)
geom_point(size = 6, shape = 21, colour = "white", stroke = 1) +
# --- 修改 1：数字在上方排成一行 ---
# y = 380 是固定高度，确保所有数字对齐成一行
geom_text(aes(y = 140, label = formatted_label),
angle = 90,             # 旋转90度
color = "black",        # 黑色字体
size = 7,               # 字体大小
hjust = 0.5,            # 水平居中对齐
fontface = "plain") +
# 设置颜色
scale_fill_manual(values = barCOLS) +
scale_color_manual(values = dotCOLS) +
# 坐标轴设置
scale_x_discrete(name = NULL) +
scale_y_continuous(name = NULL,
limits = c(-100, 150), # 调大上限给对齐的数字留空间
breaks = breaks,
labels = labels,
position = "right") +
# 主题美化
theme_minimal(base_family = "arial", base_size = 20) +
theme(
plot.background = element_blank(),
panel.background = element_blank(),
panel.grid = element_blank(),
# --- 修改 2：X轴标签旋转90度并对齐 ---
axis.text.x = element_text(color = "black",
angle = 90,
hjust = 1,    # 旋转后靠右对齐（即靠近轴线）
vjust = 0.5,  # 垂直居中
face = "bold",
size = 22),
axis.text.y = element_text(color = "black", angle = 90, face = "bold", size = 22),
axis.title = element_blank(),
axis.line = element_line(color = "black", linewidth = 1),
strip.text.x = element_blank(),
legend.position = "none"
)
# 显示
print(p)
# 保存
ggsave("Grasslandsensitivty.tiff",
p,
width = 12, height = 16, units = "cm", dpi = 500, device = "tiff")
######Naturalactive########
library(dplyr)
library(ggplot2)
# 1. 读取与筛选数据
dat <- read.csv("filled_biome_combined_data.csv")
dat3 <- dat[dat$Landuse=="Natural",]
dat1 <- dat3[dat3$Group1=="Active",]
# 2. 格式化数字：trim=TRUE 确保括号紧贴数字，无空隙
dat1$formatted_label <- paste0("(", format(dat1$N, big.mark = ",", trim = TRUE), ")")
# 定义颜色
dotCOLS = c("#AB82FF","#FFA500","#96CDCD")
barCOLS = c("#8073ac","#CD8500","#668B8B")
# 设置因子顺序
dat1$group <- factor(dat1$group, levels = c("T.ST", "Temperate", "Boreal"))
# Y 轴刻度准备
breaks = seq(-100, 150, by = 50)
labels = as.character(breaks)
# 3. 绘图
p <- dat1 %>%
mutate(facet = factor(facet, levels = c("0-30cm", "30+cm"))) %>%
ggplot(aes(x = group, y = OR, ymin = Lower, ymax = Upper, col = group, fill = group)) +
facet_grid(~ facet) +
# 误差棒
geom_errorbar(aes(ymin = Lower, ymax = Upper, col = group), width = 0.4, linewidth = 1) +
# 水平参考线 (0位线)
geom_hline(yintercept = 0, lty = 2, linewidth = 0.8) +
# 点 (Dot Bar)
geom_point(size = 6, shape = 21, colour = "white", stroke = 1) +
# --- 修改 1：数字在上方排成一行 ---
# y = 380 是固定高度，确保所有数字对齐成一行
geom_text(aes(y = 140, label = formatted_label),
angle = 90,             # 旋转90度
color = "black",        # 黑色字体
size = 7,               # 字体大小
hjust = 0.5,            # 水平居中对齐
fontface = "plain") +
# 设置颜色
scale_fill_manual(values = barCOLS) +
scale_color_manual(values = dotCOLS) +
# 坐标轴设置
scale_x_discrete(name = NULL) +
scale_y_continuous(name = NULL,
limits = c(-100, 150), # 调大上限给对齐的数字留空间
breaks = breaks,
labels = labels,
position = "right") +
# 主题美化
theme_minimal(base_family = "arial", base_size = 20) +
theme(
plot.background = element_blank(),
panel.background = element_blank(),
panel.grid = element_blank(),
# --- 修改 2：X轴标签旋转90度并对齐 ---
axis.text.x = element_text(color = "black",
angle = 90,
hjust = 1,    # 旋转后靠右对齐（即靠近轴线）
vjust = 0.5,  # 垂直居中
face = "bold",
size = 22),
axis.text.y = element_text(color = "black", angle = 90, face = "bold", size = 22),
axis.title = element_blank(),
axis.line = element_line(color = "black", linewidth = 1),
strip.text.x = element_blank(),
legend.position = "none"
)
# 显示
print(p)
# 保存
ggsave("Naturalactive.tiff",
p,
width = 12, height = 16, units = "cm", dpi = 500, device = "tiff")
######Naturalpassive########
library(dplyr)
library(ggplot2)
# 1. 读取与筛选数据
dat <- read.csv("filled_biome_combined_data.csv")
dat3 <- dat[dat$Landuse=="Natural",]
dat1 <- dat3[dat3$Group1=="Passive",]
# 2. 格式化数字：trim=TRUE 确保括号紧贴数字，无空隙
dat1$formatted_label <- paste0("(", format(dat1$N, big.mark = ",", trim = TRUE), ")")
# 定义颜色
dotCOLS = c("#AB82FF","#FFA500","#96CDCD")
barCOLS = c("#8073ac","#CD8500","#668B8B")
# 设置因子顺序
dat1$group <- factor(dat1$group, levels = c("T.ST", "Temperate", "Boreal"))
# Y 轴刻度准备
breaks = seq(-100, 150, by = 50)
labels = as.character(breaks)
# 3. 绘图
p <- dat1 %>%
mutate(facet = factor(facet, levels = c("0-30cm", "30+cm"))) %>%
ggplot(aes(x = group, y = OR, ymin = Lower, ymax = Upper, col = group, fill = group)) +
facet_grid(~ facet) +
# 误差棒
geom_errorbar(aes(ymin = Lower, ymax = Upper, col = group), width = 0.4, linewidth = 1) +
# 水平参考线 (0位线)
geom_hline(yintercept = 0, lty = 2, linewidth = 0.8) +
# 点 (Dot Bar)
geom_point(size = 6, shape = 21, colour = "white", stroke = 1) +
# --- 修改 1：数字在上方排成一行 ---
# y = 380 是固定高度，确保所有数字对齐成一行
geom_text(aes(y = 140, label = formatted_label),
angle = 90,             # 旋转90度
color = "black",        # 黑色字体
size = 7,               # 字体大小
hjust = 0.5,            # 水平居中对齐
fontface = "plain") +
# 设置颜色
scale_fill_manual(values = barCOLS) +
scale_color_manual(values = dotCOLS) +
# 坐标轴设置
scale_x_discrete(name = NULL) +
scale_y_continuous(name = NULL,
limits = c(-100, 150), # 调大上限给对齐的数字留空间
breaks = breaks,
labels = labels,
position = "right") +
# 主题美化
theme_minimal(base_family = "arial", base_size = 20) +
theme(
plot.background = element_blank(),
panel.background = element_blank(),
panel.grid = element_blank(),
# --- 修改 2：X轴标签旋转90度并对齐 ---
axis.text.x = element_text(color = "black",
angle = 90,
hjust = 1,    # 旋转后靠右对齐（即靠近轴线）
vjust = 0.5,  # 垂直居中
face = "bold",
size = 22),
axis.text.y = element_text(color = "black", angle = 90, face = "bold", size = 22),
axis.title = element_blank(),
axis.line = element_line(color = "black", linewidth = 1),
strip.text.x = element_blank(),
legend.position = "none"
)
# 显示
print(p)
# 保存
ggsave("NaturalPassive.tiff",
p,
width = 12, height = 16, units = "cm", dpi = 500, device = "tiff")
######NaturalSOC########
library(dplyr)
library(ggplot2)
# 1. 读取与筛选数据
dat <- read.csv("filled_biome_combined_data.csv")
dat3 <- dat[dat$Landuse=="Natural",]
dat1 <- dat3[dat3$Group1=="SOC",]
# 2. 格式化数字：trim=TRUE 确保括号紧贴数字，无空隙
dat1$formatted_label <- paste0("(", format(dat1$N, big.mark = ",", trim = TRUE), ")")
# 定义颜色
dotCOLS = c("#AB82FF","#FFA500","#96CDCD")
barCOLS = c("#8073ac","#CD8500","#668B8B")
# 设置因子顺序
dat1$group <- factor(dat1$group, levels = c("T.ST", "Temperate", "Boreal"))
# Y 轴刻度准备
breaks = seq(-100, 150, by = 50)
labels = as.character(breaks)
# 3. 绘图
p <- dat1 %>%
mutate(facet = factor(facet, levels = c("0-30cm", "30+cm"))) %>%
ggplot(aes(x = group, y = OR, ymin = Lower, ymax = Upper, col = group, fill = group)) +
facet_grid(~ facet) +
# 误差棒
geom_errorbar(aes(ymin = Lower, ymax = Upper, col = group), width = 0.4, linewidth = 1) +
# 水平参考线 (0位线)
geom_hline(yintercept = 0, lty = 2, linewidth = 0.8) +
# 点 (Dot Bar)
geom_point(size = 6, shape = 21, colour = "white", stroke = 1) +
# --- 修改 1：数字在上方排成一行 ---
# y = 380 是固定高度，确保所有数字对齐成一行
geom_text(aes(y = 140, label = formatted_label),
angle = 90,             # 旋转90度
color = "black",        # 黑色字体
size = 7,               # 字体大小
hjust = 0.5,            # 水平居中对齐
fontface = "plain") +
# 设置颜色
scale_fill_manual(values = barCOLS) +
scale_color_manual(values = dotCOLS) +
# 坐标轴设置
scale_x_discrete(name = NULL) +
scale_y_continuous(name = NULL,
limits = c(-100, 150), # 调大上限给对齐的数字留空间
breaks = breaks,
labels = labels,
position = "right") +
# 主题美化
theme_minimal(base_family = "arial", base_size = 20) +
theme(
plot.background = element_blank(),
panel.background = element_blank(),
panel.grid = element_blank(),
# --- 修改 2：X轴标签旋转90度并对齐 ---
axis.text.x = element_text(color = "black",
angle = 90,
hjust = 1,    # 旋转后靠右对齐（即靠近轴线）
vjust = 0.5,  # 垂直居中
face = "bold",
size = 22),
axis.text.y = element_text(color = "black", angle = 90, face = "bold", size = 22),
axis.title = element_blank(),
axis.line = element_line(color = "black", linewidth = 1),
strip.text.x = element_blank(),
legend.position = "none"
)
# 显示
print(p)
# 保存
ggsave("NaturalSOC.tiff",
p,
width = 12, height = 16, units = "cm", dpi = 500, device = "tiff")
######NaturalSensivity########
library(dplyr)
library(ggplot2)
# 1. 读取与筛选数据
dat <- read.csv("filled_biome_combined_data.csv")
dat3 <- dat[dat$Landuse=="Natural",]
dat1 <- dat3[dat3$Group1=="Sensitivity",]
# 2. 格式化数字：trim=TRUE 确保括号紧贴数字，无空隙
dat1$formatted_label <- paste0("(", format(dat1$N, big.mark = ",", trim = TRUE), ")")
# 定义颜色
dotCOLS = c("#AB82FF","#FFA500","#96CDCD")
barCOLS = c("#8073ac","#CD8500","#668B8B")
# 设置因子顺序
dat1$group <- factor(dat1$group, levels = c("T.ST", "Temperate", "Boreal"))
# Y 轴刻度准备
breaks = seq(-100, 150, by = 50)
labels = as.character(breaks)
# 3. 绘图
p <- dat1 %>%
mutate(facet = factor(facet, levels = c("0-30cm", "30+cm"))) %>%
ggplot(aes(x = group, y = OR, ymin = Lower, ymax = Upper, col = group, fill = group)) +
facet_grid(~ facet) +
# 误差棒
geom_errorbar(aes(ymin = Lower, ymax = Upper, col = group), width = 0.4, linewidth = 1) +
# 水平参考线 (0位线)
geom_hline(yintercept = 0, lty = 2, linewidth = 0.8) +
# 点 (Dot Bar)
geom_point(size = 6, shape = 21, colour = "white", stroke = 1) +
# --- 修改 1：数字在上方排成一行 ---
# y = 380 是固定高度，确保所有数字对齐成一行
geom_text(aes(y = 140, label = formatted_label),
angle = 90,             # 旋转90度
color = "black",        # 黑色字体
size = 7,               # 字体大小
hjust = 0.5,            # 水平居中对齐
fontface = "plain") +
# 设置颜色
scale_fill_manual(values = barCOLS) +
scale_color_manual(values = dotCOLS) +
# 坐标轴设置
scale_x_discrete(name = NULL) +
scale_y_continuous(name = NULL,
limits = c(-100, 150), # 调大上限给对齐的数字留空间
breaks = breaks,
labels = labels,
position = "right") +
# 主题美化
theme_minimal(base_family = "arial", base_size = 20) +
theme(
plot.background = element_blank(),
panel.background = element_blank(),
panel.grid = element_blank(),
# --- 修改 2：X轴标签旋转90度并对齐 ---
axis.text.x = element_text(color = "black",
angle = 90,
hjust = 1,    # 旋转后靠右对齐（即靠近轴线）
vjust = 0.5,  # 垂直居中
face = "bold",
size = 22),
axis.text.y = element_text(color = "black", angle = 90, face = "bold", size = 22),
axis.title = element_blank(),
axis.line = element_line(color = "black", linewidth = 1),
strip.text.x = element_blank(),
legend.position = "none"
)
# 显示
print(p)
# 保存
ggsave("Naturalsensitivty.tiff",
p,
width = 12, height = 16, units = "cm", dpi = 500, device = "tiff")
######GrasslandSOC########
library(dplyr)
library(ggplot2)
# 1. 读取与筛选数据
dat <- read.csv("filled_biome_combined_data.csv")
dat3 <- dat[dat$Landuse=="Grassland",]
dat1 <- dat3[dat3$Group1=="SOC",]
# 2. 格式化数字：trim=TRUE 确保括号紧贴数字，无空隙
dat1$formatted_label <- paste0("(", format(dat1$N, big.mark = ",", trim = TRUE), ")")
# 定义颜色
dotCOLS = c("#AB82FF","#FFA500","#96CDCD")
barCOLS = c("#8073ac","#CD8500","#668B8B")
# 设置因子顺序
dat1$group <- factor(dat1$group, levels = c("T.ST", "Temperate", "Boreal"))
# Y 轴刻度准备
breaks = seq(-100, 150, by = 50)
labels = as.character(breaks)
# 3. 绘图
p <- dat1 %>%
mutate(facet = factor(facet, levels = c("0-30cm", "30+cm"))) %>%
ggplot(aes(x = group, y = OR, ymin = Lower, ymax = Upper, col = group, fill = group)) +
facet_grid(~ facet) +
# 误差棒
geom_errorbar(aes(ymin = Lower, ymax = Upper, col = group), width = 0.4, linewidth = 1) +
# 水平参考线 (0位线)
geom_hline(yintercept = 0, lty = 2, linewidth = 0.8) +
# 点 (Dot Bar)
geom_point(size = 6, shape = 21, colour = "white", stroke = 1) +
# --- 修改 1：数字在上方排成一行 ---
# y = 380 是固定高度，确保所有数字对齐成一行
geom_text(aes(y = 140, label = formatted_label),
angle = 90,             # 旋转90度
color = "black",        # 黑色字体
size = 7,               # 字体大小
hjust = 0.5,            # 水平居中对齐
fontface = "plain") +
# 设置颜色
scale_fill_manual(values = barCOLS) +
scale_color_manual(values = dotCOLS) +
# 坐标轴设置
scale_x_discrete(name = NULL) +
scale_y_continuous(name = NULL,
limits = c(-100, 150), # 调大上限给对齐的数字留空间
breaks = breaks,
labels = labels,
position = "right") +
# 主题美化
theme_minimal(base_family = "arial", base_size = 20) +
theme(
plot.background = element_blank(),
panel.background = element_blank(),
panel.grid = element_blank(),
# --- 修改 2：X轴标签旋转90度并对齐 ---
axis.text.x = element_text(color = "black",
angle = 90,
hjust = 1,    # 旋转后靠右对齐（即靠近轴线）
vjust = 0.5,  # 垂直居中
face = "bold",
size = 22),
axis.text.y = element_text(color = "black", angle = 90, face = "bold", size = 22),
axis.title = element_blank(),
axis.line = element_line(color = "black", linewidth = 1),
strip.text.x = element_blank(),
legend.position = "none"
)
# 显示
print(p)
# 保存
ggsave("GrasslandSOC.tiff",
p,
width = 12, height = 16, units = "cm", dpi = 500, device = "tiff")
# 显示
print(p)
# 保存
ggsave("GrasslandSOC.tiff",
p,
width = 14, height = 16, units = "cm", dpi = 500, device = "tiff")
