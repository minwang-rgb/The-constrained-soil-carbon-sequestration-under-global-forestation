df[3,5]=r4$pval[3]
df[1,6]=r4$zval[1]
df[2,6]=r4$zval[2]
df[3,6]=r4$zval[3]
df[1,7]=r4$se[1]
df[2,7]=r4$se[2]
df[3,7]=r4$se[3]
df[1,8]=r4$sigma2[1]
df[1,9]=r4$sigma2[2]
df[1,10]=r4$sigma2[3]
df[1,11]=r4$QM
df[1,12]=r4$QMp
df[1,13]=r4$k
rownames(df) <- c("Active","Passive","SOC")
names(df)[1]="Naturaltop"
names(df)[2]="estimate"
names(df)[3]="ci.lb"
names(df)[4]="ci.ub"
names(df)[5]="pval"
names(df)[6]="zval"
names(df)[7]="se"
names(df)[8]="sigma1"
names(df)[9]="sigma2"
names(df)[10]="sigma3"
names(df)[11]="Qm"
names(df)[12]="QmP"
names(df)[13]="K"
dat9<-tabyl(dat5,Var)
data_msd7<- cbind(df,dat9)
names(data_msd7)[15]="number"
data_msdfinal1 <- rbind(data_msd7)
write.csv(data_msdfinal1,file="/Users/min/Desktop/NEE/biome/Natural4.csv")
rm(list=ls())
#######################Natural5#################
dat1 <- read.csv("2025S0202.csv")
dat2 <- dat1[dat1$Control=="Natural",]
dat3 <- dat2[dat2$biome=="5",]
dat5 <- dat3[dat3$Soil.layer=="topsoil",]
dat5 <- dat5[!is.na(dat5$Ref), ]
r4<-rma.mv(yi,vi,mods = ~Var-1,data=dat5, random=~1|Ref/studysite/Case, method="REML",sparse = T)
summary(r4)
df=data.frame()
df[1,1]=r4$b[1]
df[2,1]=r4$b[2]
df[3,1]=r4$b[3]
df[1,2]=r4$b[1]
df[2,2]=r4$b[2]
df[3,2]=r4$b[3]
df[1,3]=r4$ci.lb[1]
df[2,3]=r4$ci.lb[2]
df[3,3]=r4$ci.lb[3]
df[1,4]=r4$ci.ub[1]
df[2,4]=r4$ci.ub[2]
df[3,4]=r4$ci.ub[3]
df[1,5]=r4$pval[1]
df[2,5]=r4$pval[2]
df[3,5]=r4$pval[3]
df[1,6]=r4$zval[1]
df[2,6]=r4$zval[2]
df[3,6]=r4$zval[3]
df[1,7]=r4$se[1]
df[2,7]=r4$se[2]
df[3,7]=r4$se[3]
df[1,8]=r4$sigma2[1]
df[1,9]=r4$sigma2[2]
df[1,10]=r4$sigma2[3]
df[1,11]=r4$QM
df[1,12]=r4$QMp
df[1,13]=r4$k
rownames(df) <- c("Active","Passive","SOC")
names(df)[1]="Naturaltop"
names(df)[2]="estimate"
names(df)[3]="ci.lb"
names(df)[4]="ci.ub"
names(df)[5]="pval"
names(df)[6]="zval"
names(df)[7]="se"
names(df)[8]="sigma1"
names(df)[9]="sigma2"
names(df)[10]="sigma3"
names(df)[11]="Qm"
names(df)[12]="QmP"
names(df)[13]="K"
#########################################################subsoil
dat1 <- read.csv("2025S0202.csv")
dat2 <- dat1[dat1$Control=="Natural",]
dat4 <- dat2[dat2$biome=="5",]
dat6 <- dat4[dat4$Soil.layer=="subsoil",]
dat6 <- dat6[!is.na(dat6$Ref), ]
r5<-rma.mv(yi,vi,mods = ~Var-1,data=dat6, random=~1|Ref/studysite/Case, method="REML",sparse = T)
summary(r5)
df1=data.frame()
df1[1,1]=r5$b[1]
df1[2,1]=r5$b[2]
df1[3,1]=r5$b[3]
df1[1,2]=r5$b[1]
df1[2,2]=r5$b[2]
df1[3,2]=r5$b[3]
df1[1,3]=r5$ci.lb[1]
df1[2,3]=r5$ci.lb[2]
df1[3,3]=r5$ci.lb[3]
df1[1,4]=r5$ci.ub[1]
df1[2,4]=r5$ci.ub[2]
df1[3,4]=r5$ci.ub[3]
df1[1,5]=r5$pval[1]
df1[2,5]=r5$pval[2]
df1[3,5]=r5$pval[3]
df1[1,6]=r5$zval[1]
df1[2,6]=r5$zval[2]
df1[3,6]=r5$zval[3]
df1[1,7]=r5$se[1]
df1[2,7]=r5$se[2]
df1[3,7]=r5$se[3]
df1[1,8]=r5$sigma2[1]
df1[1,9]=r5$sigma2[2]
df1[1,10]=r5$sigma2[3]
df1[1,11]=r5$QM
df1[1,12]=r5$QMp
df1[1,13]=r5$k
rownames(df1) <- c("Active","Passive","SOC")
names(df1)[1]="Naturaltop"
names(df1)[2]="estimate"
names(df1)[3]="ci.lb"
names(df1)[4]="ci.ub"
names(df1)[5]="pval"
names(df1)[6]="zval"
names(df1)[7]="se"
names(df1)[8]="sigma1"
names(df1)[9]="sigma2"
names(df1)[10]="sigma3"
names(df1)[11]="Qm"
names(df1)[12]="QmP"
names(df1)[13]="K"
dat9<-tabyl(dat5,Var)
data_msd7<- cbind(df,dat9)
names(data_msd7)[15]="number"
dat10<-tabyl(dat6,Var)
data_msd8<- cbind(df1,dat10)
names(data_msd8)[15]="number"
data_msdfinal1 <- rbind(data_msd7,data_msd8)
write.csv(data_msdfinal1,file="/Users/min/Desktop/NEE/biome/Natural5.csv")
rm(list=ls())
#######################Natural6#################
dat1 <- read.csv("2025S0202.csv")
dat2 <- dat1[dat1$Control=="Natural",]
dat3 <- dat2[dat2$biome=="6",]
dat5 <- dat3[dat3$Soil.layer=="topsoil",]
dat5 <- dat5[!is.na(dat5$Ref), ]
r4<-rma.mv(yi,vi,mods = ~Var-1,data=dat5, random=~1|Ref/studysite/Case, method="REML",sparse = T)
summary(r4)
df=data.frame()
df[1,1]=r4$b[1]
df[2,1]=r4$b[2]
df[3,1]=r4$b[3]
df[1,2]=r4$b[1]
df[2,2]=r4$b[2]
df[3,2]=r4$b[3]
df[1,3]=r4$ci.lb[1]
df[2,3]=r4$ci.lb[2]
df[3,3]=r4$ci.lb[3]
df[1,4]=r4$ci.ub[1]
df[2,4]=r4$ci.ub[2]
df[3,4]=r4$ci.ub[3]
df[1,5]=r4$pval[1]
df[2,5]=r4$pval[2]
df[3,5]=r4$pval[3]
df[1,6]=r4$zval[1]
df[2,6]=r4$zval[2]
df[3,6]=r4$zval[3]
df[1,7]=r4$se[1]
df[2,7]=r4$se[2]
df[3,7]=r4$se[3]
df[1,8]=r4$sigma2[1]
df[1,9]=r4$sigma2[2]
df[1,10]=r4$sigma2[3]
df[1,11]=r4$QM
df[1,12]=r4$QMp
df[1,13]=r4$k
rownames(df) <- c("Active","Passive","SOC")
names(df)[1]="Naturaltop"
names(df)[2]="estimate"
names(df)[3]="ci.lb"
names(df)[4]="ci.ub"
names(df)[5]="pval"
names(df)[6]="zval"
names(df)[7]="se"
names(df)[8]="sigma1"
names(df)[9]="sigma2"
names(df)[10]="sigma3"
names(df)[11]="Qm"
names(df)[12]="QmP"
names(df)[13]="K"
dat9<-tabyl(dat5,Var)
data_msd7<- cbind(df,dat9)
names(data_msd7)[15]="number"
data_msdfinal1 <- rbind(data_msd7)
write.csv(data_msdfinal1,file="/Users/min/Desktop/NEE/biome/Natural6.csv")
rm(list=ls())
#######################Natural9#################
dat1 <- read.csv("2025S0202.csv")
dat2 <- dat1[dat1$Control=="Natural",]
dat3 <- dat2[dat2$biome=="9",]
dat5 <- dat3[dat3$Soil.layer=="topsoil",]
dat5 <- dat5[!is.na(dat5$Ref), ]
r4<-rma.mv(yi,vi,mods = ~Var-1,data=dat5, random=~1|Ref/studysite/Case, method="REML",sparse = T)
summary(r4)
df=data.frame()
df[1,1]=r4$b[1]
df[2,1]=r4$b[2]
df[3,1]=r4$b[3]
df[1,2]=r4$b[1]
df[2,2]=r4$b[2]
df[3,2]=r4$b[3]
df[1,3]=r4$ci.lb[1]
df[2,3]=r4$ci.lb[2]
df[3,3]=r4$ci.lb[3]
df[1,4]=r4$ci.ub[1]
df[2,4]=r4$ci.ub[2]
df[3,4]=r4$ci.ub[3]
df[1,5]=r4$pval[1]
df[2,5]=r4$pval[2]
df[3,5]=r4$pval[3]
df[1,6]=r4$zval[1]
df[2,6]=r4$zval[2]
df[3,6]=r4$zval[3]
df[1,7]=r4$se[1]
df[2,7]=r4$se[2]
df[3,7]=r4$se[3]
df[1,8]=r4$sigma2[1]
df[1,9]=r4$sigma2[2]
df[1,10]=r4$sigma2[3]
df[1,11]=r4$QM
df[1,12]=r4$QMp
df[1,13]=r4$k
rownames(df) <- c("Active","Passive","SOC")
names(df)[1]="Naturaltop"
names(df)[2]="estimate"
names(df)[3]="ci.lb"
names(df)[4]="ci.ub"
names(df)[5]="pval"
names(df)[6]="zval"
names(df)[7]="se"
names(df)[8]="sigma1"
names(df)[9]="sigma2"
names(df)[10]="sigma3"
names(df)[11]="Qm"
names(df)[12]="QmP"
names(df)[13]="K"
#########################################################subsoil
dat1 <- read.csv("2025S0202.csv")
dat2 <- dat1[dat1$Control=="Natural",]
dat4 <- dat2[dat2$biome=="9",]
dat6 <- dat4[dat4$Soil.layer=="subsoil",]
dat6 <- dat6[!is.na(dat6$Ref), ]
r5<-rma.mv(yi,vi,mods = ~Var-1,data=dat6, random=~1|Ref/studysite/Case, method="REML",sparse = T)
summary(r5)
df1=data.frame()
df1[1,1]=r5$b[1]
df1[2,1]=r5$b[2]
df1[3,1]=r5$b[3]
df1[1,2]=r5$b[1]
df1[2,2]=r5$b[2]
df1[3,2]=r5$b[3]
df1[1,3]=r5$ci.lb[1]
df1[2,3]=r5$ci.lb[2]
df1[3,3]=r5$ci.lb[3]
df1[1,4]=r5$ci.ub[1]
df1[2,4]=r5$ci.ub[2]
df1[3,4]=r5$ci.ub[3]
df1[1,5]=r5$pval[1]
df1[2,5]=r5$pval[2]
df1[3,5]=r5$pval[3]
df1[1,6]=r5$zval[1]
df1[2,6]=r5$zval[2]
df1[3,6]=r5$zval[3]
df1[1,7]=r5$se[1]
df1[2,7]=r5$se[2]
df1[3,7]=r5$se[3]
df1[1,8]=r5$sigma2[1]
df1[1,9]=r5$sigma2[2]
df1[1,10]=r5$sigma2[3]
df1[1,11]=r5$QM
df1[1,12]=r5$QMp
df1[1,13]=r5$k
rownames(df1) <- c("Active","Passive","SOC")
names(df1)[1]="Naturaltop"
names(df1)[2]="estimate"
names(df1)[3]="ci.lb"
names(df1)[4]="ci.ub"
names(df1)[5]="pval"
names(df1)[6]="zval"
names(df1)[7]="se"
names(df1)[8]="sigma1"
names(df1)[9]="sigma2"
names(df1)[10]="sigma3"
names(df1)[11]="Qm"
names(df1)[12]="QmP"
names(df1)[13]="K"
dat9<-tabyl(dat5,Var)
data_msd7<- cbind(df,dat9)
names(data_msd7)[15]="number"
dat10<-tabyl(dat6,Var)
data_msd8<- cbind(df1,dat10)
names(data_msd8)[15]="number"
data_msdfinal1 <- rbind(data_msd7,data_msd8)
write.csv(data_msdfinal1,file="/Users/min/Desktop/NEE/biome/Natural9.csv")
rm(list=ls())
library(metafor)
library(dplyr)
library(writexl)
library(Rmisc)
library(readxl)
library(ggplot2)
library(dplyr)
library(metafor)
setwd("/Users/min/Desktop/NEE/total")
dat1 <- read.csv("totalindex2025.csv")
rm(list=ls())
dat1 <- read.csv("totalindex2025.csv")
dotCOLS = c("#FFA500","#96CDCD","#FFD700","#a6d8f0")#bar
barCOLS = c("#CD8500","#668B8B","#FFC125","#008fd5")#dot
dat1$group <- factor(dat1$group,levels = c("Active","Nonactive","SOC","Sensitivity"))
breaks = c(seq(-1,2, by=2), 2)
# and labels
labels = as.character(breaks)
p <- dat1 %>%
mutate(facet = factor(facet, levels = c("0-30cm","30+cm")))%>%
ggplot(aes(x = group,
y=OR, ymin=Lower, ymax=Upper,col=group,fill=group)) +
facet_grid(~ facet)+
#specify position here
geom_errorbar(aes(ymin=Lower, ymax=Upper,col=group),width=0.5,cex=1)+
geom_hline(yintercept=0, lty=2,size = 1) +
#specify position here too
geom_point(size=5, shape=21, colour="white", stroke = 1,position=position_dodge(width = 0.5)) +
scale_fill_manual(values=barCOLS)+
scale_color_manual(values=dotCOLS)+
scale_x_discrete(name="") +
scale_y_continuous(name="",
limits = c(-1, 2),breaks = breaks, labels = labels,position="right") +
theme_minimal()+
theme(legend.position = "none")+
theme(axis.text=element_text(family="arial", face="bold",size=18)) +
theme(text = element_text(family="arial", face="bold",size = 20))+
theme(axis.title.y = element_text(face="bold"))+
theme(panel.background = element_blank())+
theme(axis.text.x.bottom = element_blank())+
theme(strip.text.x = element_blank())+
theme(axis.text.y = element_text(angle = 90))+
theme(axis.title.y.right = element_text (angle = 90,margin= unit(c(2,2,2,0.5),"cm")))+
theme(axis.line.y.right = element_line(color = "black",size = 1,linetype = "solid" ))+
theme(axis.line.x = element_line(color = "black",size = 1,linetype = "solid" ))+
theme(axis.line.y.left = element_line(color = "black",size = 1,linetype = "solid" ))+
theme(axis.line.x.top = element_line(color = "black",size = 1,linetype = "solid" ))
p
View(dat1)
ggsave("Sandy.tiff",
p,
width = 15, height = 11, units = "cm", dpi = 500, device = "tiff")
rm(list=ls())
dat1 <- read.csv("restorationmode.csv")
dotCOLS = c("#FFA500","#96CDCD","#FFD700","#a6d8f0")#bar
barCOLS = c("#CD8500","#668B8B","#FFC125","#008fd5")#dot
dat1$group <- factor(dat1$group,levels = c("Active","Nonactive","SOC","Sensitivity"))
breaks = c(seq(-1,1, by=1), 1)
# and labels
labels = as.character(breaks)
p <- dat1 %>%
mutate(facet = factor(facet, levels = c("0-30cm","30+cm")))%>%
ggplot(aes(x = group,
y=OR, ymin=Lower, ymax=Upper,col=group,fill=group)) +
facet_grid(~ facet)+
#specify position here
geom_errorbar(aes(ymin=Lower, ymax=Upper,col=group),width=0.5,cex=1)+
geom_hline(yintercept=0, lty=2,size = 1) +
#specify position here too
geom_point(size=5, shape=21, colour="white", stroke = 1,position=position_dodge(width = 0.5)) +
scale_fill_manual(values=barCOLS)+
scale_color_manual(values=dotCOLS)+
scale_x_discrete(name="") +
scale_y_continuous(name="",
limits = c(-1, 1),breaks = breaks, labels = labels,position="right") +
theme_minimal()+
theme(legend.position = "none")+
theme(axis.text=element_text(family="arial", face="bold",size=18)) +
theme(text = element_text(family="arial", face="bold",size = 20))+
theme(axis.title.y = element_text(face="bold"))+
theme(panel.background = element_blank())+
theme(axis.text.x.bottom = element_blank())+
theme(strip.text.x = element_blank())+
theme(axis.text.y = element_text(angle = 90))+
theme(axis.title.y.right = element_text (angle = 90,margin= unit(c(2,2,2,0.5),"cm")))+
theme(axis.line.y.right = element_line(color = "black",size = 1,linetype = "solid" ))+
theme(axis.line.x = element_line(color = "black",size = 1,linetype = "solid" ))+
theme(axis.line.y.left = element_line(color = "black",size = 1,linetype = "solid" ))+
theme(axis.line.x.top = element_line(color = "black",size = 1,linetype = "solid" ))
rm(list=ls())
dat1 <- read.csv("restorationmode.csv")
dotCOLS = c("#FFA500","#96CDCD","#FFD700","#a6d8f0")#bar
library(metafor)
library(dplyr)
library(writexl)
library(Rmisc)
library(readxl)
library(ggplot2)
library(dplyr)
library(metafor)
setwd("/Users/min/Desktop/NEE/total")
library(metafor)
library(dplyr)
library(writexl)
library(Rmisc)
library(readxl)
library(ggplot2)
library(dplyr)
library(metafor)
setwd("/Users/min/Desktop/NEE/total")
#####restorationmode########
#####croplandartificial########
setwd("/Users/min/Desktop/NEE/restorationmode")
dat1 <- read.csv("restorationmode.csv")
dotCOLS = c("#FFA500","#96CDCD","#FFD700","#a6d8f0")#bar
barCOLS = c("#CD8500","#668B8B","#FFC125","#008fd5")#dot
dat1$group <- factor(dat1$group,levels = c("Active","Nonactive","SOC","Sensitivity"))
breaks = c(seq(-1,1, by=1), 1)
# and labels
labels = as.character(breaks)
p <- dat1 %>%
mutate(facet = factor(facet, levels = c("0-30cm","30+cm")))%>%
ggplot(aes(x = group,
y=OR, ymin=Lower, ymax=Upper,col=group,fill=group)) +
facet_grid(~ facet)+
#specify position here
geom_errorbar(aes(ymin=Lower, ymax=Upper,col=group),width=0.5,cex=1)+
geom_hline(yintercept=0, lty=2,size = 1) +
#specify position here too
geom_point(size=5, shape=21, colour="white", stroke = 1,position=position_dodge(width = 0.5)) +
scale_fill_manual(values=barCOLS)+
scale_color_manual(values=dotCOLS)+
scale_x_discrete(name="") +
scale_y_continuous(name="",
limits = c(-1, 1),breaks = breaks, labels = labels,position="right") +
theme_minimal()+
theme(legend.position = "none")+
theme(axis.text=element_text(family="arial", face="bold",size=18)) +
theme(text = element_text(family="arial", face="bold",size = 20))+
theme(axis.title.y = element_text(face="bold"))+
theme(panel.background = element_blank())+
theme(axis.text.x.bottom = element_blank())+
theme(strip.text.x = element_blank())+
theme(axis.text.y = element_text(angle = 90))+
theme(axis.title.y.right = element_text (angle = 90,margin= unit(c(2,2,2,0.5),"cm")))+
theme(axis.line.y.right = element_line(color = "black",size = 1,linetype = "solid" ))+
theme(axis.line.x = element_line(color = "black",size = 1,linetype = "solid" ))+
theme(axis.line.y.left = element_line(color = "black",size = 1,linetype = "solid" ))+
theme(axis.line.x.top = element_line(color = "black",size = 1,linetype = "solid" ))
p
ggsave("grasslandartificial.tiff",
p,
width = 15, height = 11, units = "cm", dpi = 500, device = "tiff")
rm(list=ls())
rm(list=ls())
#########age##############
#########croplandP1##############
setwd("/Users/min/Desktop/NEE/age")
dat1 <- read.csv("age.csv")
#########croplandP2##############
setwd("/Users/min/Desktop/NEE/age")
dat1 <- read.csv("age.csv")
dotCOLS = c("#FFA500","#96CDCD","#FFD700","#a6d8f0")#bar
barCOLS = c("#CD8500","#668B8B","#FFC125","#008fd5")#dot
dat1$group <- factor(dat1$group,levels = c("Active","Nonactive","SOC","Sensitivity"))
breaks = c(seq(-1,1, by=1), 1)
# and labels
labels = as.character(breaks)
p <- dat1 %>%
mutate(facet = factor(facet, levels = c("0-30cm","30+cm")))%>%
ggplot(aes(x = group,
y=OR, ymin=Lower, ymax=Upper,col=group,fill=group)) +
facet_grid(~ facet)+
#specify position here
geom_errorbar(aes(ymin=Lower, ymax=Upper,col=group),width=0.5,cex=1)+
geom_hline(yintercept=0, lty=2,size = 1) +
#specify position here too
geom_point(size=5, shape=21, colour="white", stroke = 1,position=position_dodge(width = 0.5)) +
scale_fill_manual(values=barCOLS)+
scale_color_manual(values=dotCOLS)+
scale_x_discrete(name="") +
scale_y_continuous(name="",
limits = c(-1, 1),breaks = breaks, labels = labels,position="right") +
theme_minimal()+
theme(legend.position = "none")+
theme(axis.text=element_text(family="arial", face="bold",size=18)) +
theme(text = element_text(family="arial", face="bold",size = 20))+
theme(axis.title.y = element_text(face="bold"))+
theme(panel.background = element_blank())+
theme(axis.text.x.bottom = element_blank())+
theme(strip.text.x = element_blank())+
theme(axis.text.y = element_text(angle = 90))+
theme(axis.title.y.right = element_text (angle = 90,margin= unit(c(2,2,2,0.5),"cm")))+
theme(axis.line.y.right = element_line(color = "black",size = 1,linetype = "solid" ))+
theme(axis.line.x = element_line(color = "black",size = 1,linetype = "solid" ))+
theme(axis.line.y.left = element_line(color = "black",size = 1,linetype = "solid" ))+
theme(axis.line.x.top = element_line(color = "black",size = 1,linetype = "solid" ))
p
ggsave("croplandP2.tiff",
p,
width = 15, height = 11, units = "cm", dpi = 500, device = "tiff")
rm(list=ls())
library(ggplot2)
library(dplyr)
library(tidyr)
